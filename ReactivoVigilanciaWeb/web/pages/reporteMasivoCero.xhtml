<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                template="../template/mainMenuTemplate.xhtml">
    <ui:define name="content">
        <script language="javascript" type="text/javascript">
            //*** Este Codigo permite Validar que sea un campo Numerico
            //****************************************************************
            //****************************************************************
            //****************************************************************
            function Solo_Numerico(variable) {
                Numer = parseInt(variable);
                if (isNaN(Numer)) {
                    return "";
                }
                return Numer;
            }
            //****************************************************************
            //****************************************************************
            //Fin del Codigo para Validar que sea un cfeampo Numerico
            function ValNumero(Control) {
                Control.value = Solo_Numerico(Control.value);
            }
            //****************************************************************
            //****************************************************************
            function abrirVentanaEmergente (paginaReporte)
            {
                    var d = new Date();
                    var n = d.getTime();

                    var params = [
                        'location=yes',
                        'directories=yes',
                        'status=yes',
                        'scrollbars=yes',
                        'resizable=yes',
                        'height='+screen.height*0.75,
                        'width='+screen.width*0.75,
                        'fullscreen=no' // only works in IE, but here for completeness
                    ].join(',');

                    var paginaApertura = "ventanaEmergente" + n;
                    //var popup = window.open(paginaReporte,"_blank", "resizable=yes, scrollbars=yes, menubar=yes,toolbar=yes,titlebar=yes");
                    //var popup = window.open(paginaReporte,paginaApertura,"resizable=yes, scrollbars=yes, menubar=yes,toolbar=yes,titlebar=yes");
                    var popup = window.open(paginaReporte,paginaApertura,params);
                    popup.moveTo(0,0);
                    popup.focus();
            }
            //****************************************************************
            //****************************************************************
            function validarAnoReporte()
            {
                var sePuede = true;
                var yearActual = (new Date()).getFullYear();
                var yearDigitado = jQuery("[id$='yearReporte']").val();
                
                console.log ("yearActual = " + yearActual);
                console.log ("yearDigitado = " + yearDigitado);
                
                if (yearDigitado &lt; yearActual)
                {
                    alert ("El Sistema no permite la notificación de Reportes en Cero de años anteriores al actual");
                    jQuery("[id$='yearReporte']").val("");
                    jQuery("[id$='yearReporte']").focus();
                    sePuede = false;
                }
                
                if (yearDigitado &gt; yearActual)
                {
                    alert ("El Sistema no permite la notificación de Reportes en Cero de años posteriores a los de la vigencia actual (" + yearActual + ")");
                    jQuery("[id$='yearReporte']").val("");
                    jQuery("[id$='yearReporte']").focus();
                    sePuede = false;
                }
                
                return (sePuede);
            }
            //****************************************************************
            //****************************************************************
            //****************************************************************
        </script>
        <!-- ************************************************************ -->
        <!-- ************************************************************ -->
        <!-- ************************************************************ -->
        <div align="center">
            <p:growl id="panelMensajes" showDetail="true" autoUpdate="true"/>
            <p:panel  id="panelTituloReporte" style="width:90%;text-align:left;border: none;">
                <p:panelGrid id="panelFormularioRegistro" styleClass="cssPanelesAcidos" style="width: 100%;">
                    <p:row>
                        <p:column>
                            <p:outputLabel value="RETSE008 - REPORTE TRIMESTRAL EN CERO, POR PARTE DE FABRICANTES" 
                             style="text-align: justified;font-family:Arial, Helvetica, sans-serif; font-weight:bold; font-size:0.95em;" />
                            <p:outputLabel value=" E IMPORTADORES DE REACTIVOS DE DIAGNÓSTICO IN VITRO Y PRESTADORES DE SERVICIOS DE SALUD" 
                             style="text-align: justified;font-family:Arial, Helvetica, sans-serif; font-weight:bold; font-size:0.95em;" />
                        </p:column>
                        <p:column>
                            <a href="#" onclick="abrirAyuda('visorManualReactivo.xhtml?rutaArchivoPDF=#{beanParametrosGenerales.obtenerDireccionServidor()}ManualesReactivo/docs/InstructivoCero.pdf')">
                                <b>Manual</b>
                                <p:graphicImage value="/resources/images/help.png" alt="Instructivo reporte en cero" title="Instructivo reporte en cero"/>
                            </a>
                        </p:column>
                        <p:column>
                            <a href="#" onclick="abrirAyuda('visorTutorial.xhtml?rutaVideoTutorial=#{beanParametrosGenerales.obtenerDireccionServidor()}ManualesReactivo/videos/TutReporteCero.mp4')">                                
                                <p:outputLabel value="Videotutorial de ayuda Reporte Cero"/>
                                 <p:graphicImage value="/resources/images/video.png" width="7%" height="3%"
                                                 alt="Videotutorial de ayuda reporte cero" title="Videotutorial de ayuda reporte cero"/>
                            </a>
                        </p:column>
                    </p:row>
                </p:panelGrid>
            </p:panel>
            <!--
            <h:form  onkeypress="if (event.keyCode === 13) { return false; }"   id="frmactregistroUsuario" onsubmit="return validarAnoReporte()">
            -->
            <h:form  onkeypress="if (event.keyCode === 13) { return false; }"   id="frmactregistroUsuario" prependId="false">
                <p:panel id="panelPpalRegistro" style="width:100%;text-align:left;border: none;">
                    <!-- **************************************************** -->
                    <!-- **************************************************** -->
                        <p>
                            <center>
                            <b>TIEMPOS DE NOTIFICACIÓN DEL REPORTE TRIMESTRAL SIN EVENTO</b>
                            <br/>
                            <br/>
                            <table id="fechas" cellpadding="0" cellspacing="0" border="1">
                                <tr style="background: #00B0F0">
                                    <td><b>Período</b></td>
                                    <td><b>Tiempo de Notificación</b></td>
                                </tr>
                                <tr>
                                    <td>Primer Trimestre Enero a Marzo</td>
                                    <td>Los primeros ocho (8) días calendario del mes de Abril</td>
                                </tr>
                                <tr>
                                    <td>Segundo Trimestre Abril a Junio</td>
                                    <td>Los primeros ocho (8) días calendario del mes de Julio</td>
                                </tr>
                                <tr>
                                    <td>Tercer Trimestre Julio a Septiembre</td>
                                    <td>Los primeros ocho (8) días calendario del mes de Octubre</td>
                                </tr>
                                <tr>
                                    <td>Cuarto Trimestre Octubre a Diciembre</td>
                                    <td>Los primeros ocho (8) días calendario del mes de Enero</td>
                                </tr>
                            </table>
                            </center>
                        </p>
                    <!-- **************************************************** -->
                    <!-- **************************************************** -->
                    <p:panel id="panelLugar" styleClass="panelBlue" style="width: 100%;border: none;" 
                             header="REPORTE TRIMESTRAL EN CERO, POR PARTE DE FABRICANTES E IMPORTADORES DE REACTIVOS DE DIAGNÓSTICO IN VITRO Y PRESTADORES DE SERVICIOS DE SALUD">
                        <p:panelGrid id="panelFormulario" style="width:100%;border: none;" styleClass="cssPanelesAcidos">
                           <!-- ************************************************************** -->
                            <!-- ************************************************************** -->
                            <p:row>
                                <p:column>
                                    <p:outputLabel value="1.  NIT DE LA ORGANIZACIÓN:" />
                                </p:column>
                                <p:column>
                                    <p:outputLabel value="2.  RAZÓN SOCIAL:" />
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column>
                                    <b><p:outputLabel id="nitEts" value="#{beanReporteReactivoCero.nitETSReportante}" /></b>
                                </p:column>
                                <p:column>
                                    <b><p:outputLabel id="nombreInstitucion" value="#{beanReporteReactivoCero.nombreInstitucion}" /></b>
                                </p:column>
                            </p:row>
                            <!-- ************************************************************** -->
                            <!-- ************************************************************** -->
                            <!-- ************************************************************** -->
                            <p:row>
                                <p:column colspan="2">
                                    <b>
                                        <p:outputLabel value="Nota Aclatoria:  A continuación podrá notificar ante el INVIMA que la organización, NO presentó Eventos adversos e incidentes con el uso de los reactivos de diagnóstico invitro, durante el trimestre, marcando el periodo y el año correspondiente. Este se habilita los cinco primeros días hábiles posteriores a la finalización del trimestre. " />
                                        <p:outputLabel value="Tenga en cuenta que el sistema no le permitirá realizar notificaciones de años anteriores, solo de trimestres anteriores durante la misma vigencia. Si notifica por fuera de los tiempos establecidos estos quedarán marcados como extemporáneos."/>
                                    </b>
                                </p:column>
                            </p:row>
                            <!-- ************************************************************** -->
                            <!-- ************************************************************** -->
                            <!-- ************************************************************** -->
                            <p:row>
                                <p:column>
                                    <p:outputLabel value="3.  Año de Reporte" />
                                </p:column>
                                <p:column>
                                    <p:outputLabel value="4. Período (Trimestre):" />
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column>
                                    <!--
                                    <p:outputLabel value="Registrar Reporte Extemporáneo:"/>
                                    <p:selectBooleanCheckbox id="reportaExtemporeaneo" value="#{beanReporteReactivoCero.reportaExtemporeaneo}">
                                        <p:ajax update="yearReporte" listener="#{beanReporteReactivoCero.actualizarYearsReportado}" />
                                    </p:selectBooleanCheckbox>
                                    <p:message for="reportaExtemporeaneo"/>
                                    <br/>
                                    -->
                                    <p:selectOneMenu id="yearReporte" value="#{beanReporteReactivoCero.yearReporte}" required="true" 
                                                     requiredMessage="Seleccione el Año de Reporte" style="width: 180px;">
                                        <f:selectItem itemLabel="Seleccione el Año de Reporte" itemValue="0"/>
                                        <f:selectItems value="#{beanReporteReactivoCero.yearsReportado}" />
                                    </p:selectOneMenu>
                                    <p:message for="yearReporte"/>
                                </p:column>
                                <p:column>
                                    <p:selectOneMenu id="periodoReporte" value="#{beanReporteReactivoCero.periodoReporte}" required="true" 
                                                     requiredMessage="Seleccione el Período de Reporte" style="width: 180px;">
                                        <f:selectItem itemLabel="Seleccione el Período" itemValue="0"/>
                                        <f:selectItems value="#{beanReporteReactivoCero.periodos}" />
                                    </p:selectOneMenu>
                                    <p:message for="periodoReporte"/>
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column>
                                    <p:outputLabel value="5. Observación del Reportante:" />
                                </p:column>
                                <p:column>
                                    <p:outputLabel value="" />
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column>
                                    <p:inputTextarea rows="10" cols="80" counter="display" id="observacionReportante"
                                                     value="#{beanReporteReactivoCero.observacionReportante}"
                                                     maxlength="4000" counterTemplate="{0} caracteres pendientes" />
                                    <p:message for="observacionReportante"/>
                                    <p:outputLabel id="display"/>
                                </p:column>
                                <p:column>
                                </p:column>
                            </p:row>
                            <!-- ************************************************************** -->
                            <!-- ************************************************************** -->
                        </p:panelGrid>
                    </p:panel>
                    
                    <p:panelGrid columns="1" style="text-align:center; width:100%;" styleClass="cssPanelesAcidos">
                        <p:outputLabel value="La información contenida en este reporte es información epidemiológica, por lo tanto tiene carácter confidencial 
                                       y se utilizará únicamente con fines sanitarios." style="border:0px;padding:left;font-family:Arial, Helvetica, sans-serif; font-weight:normal; font-size:0.7em;"/> 
                        <p:outputLabel value="El Ministerio de Salud y la Protección Social y el INVIMA son las únicas instituciones competentes para su divulgación. (Ley 9 de 1979)." style="border:0px;padding: left;font-family:Arial, Helvetica, sans-serif; font-weight:normal; font-size:0.7em;"/>
                    </p:panelGrid>
                    <center>
                        <p:panel id="panelBotones"  style="width: 100%;border: none;">
                            <p:panelGrid columns="2" style="text-align:center;border: none;width: 100%;" styleClass="cssPanelesAcidos" >
                                <p:commandLink value="Guardar" styleClass="vinculoSinDiv" action="#{beanReporteReactivoCero.confirmarObligatoriedad}" ajax="false"/>
                                <p:commandLink value="Cancelar" styleClass= "vinculoSinDiv" action="#{beanReporteReactivoCero.cancelar}" immediate="true" />
                            </p:panelGrid>
                        </p:panel>
                    </center>
                </p:panel>
                <!-- ******************************************************************************************* -->
                <!-- ******************************************************************************************* -->
                <!-- ******************************************************************************************* -->
                <p:dialog modal="true" resizable="false"  id="popupCrea" draggable="false" dynamic="true" widgetVar="popupCrea"
                          visible="#{not empty facesContext.messageList and facesContext.maximumSeverity.ordinal == 0}" header="Atención!" closable="false">
                    <p:panel style="border: none;alignment-adjust: central" >
                        <p:panelGrid styleClass="cssPanelesAcidos" style="border: none;width: 100%;">
                            <p:row>
                                <p:column colspan="2">
                                    <div style="font-size: 14px">
                                        <p:outputLabel value="Esta seguro de que desea enviar la información?"/>
                                        <p:message for="panelPpalRegistro"/>
                                    </div>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column>
                                    <div style="font-size: 14px;">
                                        <p:commandButton value="Aceptar " style="vinculoSinDivBoton" action="#{beanReporteReactivoCero.grabar}"  
                                                         onclick="PF('popupCrea').hide();" update="panelLugar"> 
                                        </p:commandButton>
                                    </div>
                                </p:column>
                                <p:column>
                                    <div style="font-size: 14px;">
                                        <p:commandButton value="Cancelar " style="vinculoSinDivBoton"  oncomplete="PF('popupCrea').hide()"/>
                                    </div>
                                </p:column>
                            </p:row>
                        </p:panelGrid>
                    </p:panel>
                </p:dialog>
                <!-- ******************************************************************************************* -->
                <!-- ******************************************************************************************* -->
                <!-- ******************************************************************************************* -->
            </h:form>
        </div>
    </ui:define>
</ui:composition>